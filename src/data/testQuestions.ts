import { TestQuestion, TestResult } from '@/components/InteractiveTest';

export const emotionalIntelligenceQuestions: TestQuestion[] = [
  {
    id: 'eq1',
    text: 'Как часто вы осознаете свои эмоции в момент их возникновения?',
    options: [
      { value: '5', label: 'Всегда — я сразу понимаю, что чувствую', score: 5 },
      { value: '4', label: 'Часто — в большинстве ситуаций замечаю свои эмоции', score: 4 },
      { value: '3', label: 'Иногда — только в сильных переживаниях', score: 3 },
      { value: '2', label: 'Редко — обычно осознаю постфактум', score: 2 },
      { value: '1', label: 'Практически никогда — не обращаю внимания', score: 1 }
    ]
  },
  {
    id: 'eq2',
    text: 'Насколько легко вам понять, что чувствуют другие люди?',
    options: [
      { value: '5', label: 'Очень легко — чувствую эмоции других интуитивно', score: 5 },
      { value: '4', label: 'Довольно легко — обычно понимаю настроение окружающих', score: 4 },
      { value: '3', label: 'Средне — иногда угадываю, иногда нет', score: 3 },
      { value: '2', label: 'Сложно — часто не замечаю чужих эмоций', score: 2 },
      { value: '1', label: 'Очень сложно — не понимаю, что чувствуют другие', score: 1 }
    ]
  },
  {
    id: 'eq3',
    text: 'Как вы справляетесь со стрессовыми ситуациями?',
    options: [
      { value: '5', label: 'Отлично — быстро успокаиваюсь и нахожу решение', score: 5 },
      { value: '4', label: 'Хорошо — справляюсь, но нужно время', score: 4 },
      { value: '3', label: 'По-разному — зависит от ситуации', score: 3 },
      { value: '2', label: 'Тяжело — долго переживаю и нервничаю', score: 2 },
      { value: '1', label: 'Очень тяжело — теряюсь и впадаю в панику', score: 1 }
    ]
  },
  {
    id: 'eq4',
    text: 'Как часто вы выражаете свои чувства словами?',
    options: [
      { value: '5', label: 'Очень часто — легко говорю о своих эмоциях', score: 5 },
      { value: '4', label: 'Часто — делюсь переживаниями с близкими', score: 4 },
      { value: '3', label: 'Иногда — только в важных моментах', score: 3 },
      { value: '2', label: 'Редко — мне сложно говорить о чувствах', score: 2 },
      { value: '1', label: 'Почти никогда — держу все в себе', score: 1 }
    ]
  },
  {
    id: 'eq5',
    text: 'Насколько легко вам мотивировать себя на достижение целей?',
    options: [
      { value: '5', label: 'Очень легко — я целеустремленный и настойчивый', score: 5 },
      { value: '4', label: 'Довольно легко — обычно доводу дела до конца', score: 4 },
      { value: '3', label: 'Средне — бывает и так, и так', score: 3 },
      { value: '2', label: 'Сложно — часто откладываю и бросаю начатое', score: 2 },
      { value: '1', label: 'Очень сложно — мне трудно заставить себя действовать', score: 1 }
    ]
  }
];

export function getEmotionalIntelligenceResults(answers: Record<string, string>): TestResult {
  const score = Object.values(answers).reduce((sum, val) => sum + parseInt(val), 0);
  const maxScore = 25;
  const percentage = (score / maxScore) * 100;

  let category = '';
  let interpretation = '';
  let recommendations: string[] = [];

  if (percentage >= 80) {
    category = 'Высокий уровень EQ';
    interpretation = 'У вас отличный эмоциональный интеллект! Вы хорошо понимаете свои эмоции и чувства других людей, умеете управлять своим состоянием и эффективно взаимодействуете с окружающими. Вы способны мотивировать себя и справляться со стрессом.';
    recommendations = [
      'Продолжайте развивать эмпатию через активное слушание',
      'Помогайте другим членам семьи развивать их эмоциональный интеллект',
      'Практикуйте медитацию осознанности для углубления самопознания'
    ];
  } else if (percentage >= 60) {
    category = 'Средний уровень EQ';
    interpretation = 'У вас хороший уровень эмоционального интеллекта. Вы достаточно хорошо понимаете свои эмоции и можете контролировать их в большинстве ситуаций. Есть области для дальнейшего развития, особенно в понимании чувств других людей.';
    recommendations = [
      'Практикуйте ежедневную рефлексию: что я чувствовал сегодня и почему',
      'Учитесь называть свои эмоции конкретными словами (не просто "плохо", а "разочарован", "обижен")',
      'Развивайте наблюдательность: обращайте внимание на мимику и жесты близких',
      'Практикуйте техники дыхания для управления стрессом'
    ];
  } else if (percentage >= 40) {
    category = 'Ниже среднего уровень EQ';
    interpretation = 'Ваш эмоциональный интеллект нуждается в развитии. Возможно, вам бывает сложно понимать свои чувства или чувства других людей, управлять эмоциями в стрессовых ситуациях. Хорошая новость — эмоциональный интеллект можно развить!';
    recommendations = [
      'Начните вести дневник эмоций: записывайте, что чувствовали в течение дня',
      'Учитесь распознавать базовые эмоции: радость, грусть, гнев, страх, удивление',
      'Перед сном задавайте себе вопрос: "Какие эмоции я испытал сегодня?"',
      'Читайте книги по эмоциональному интеллекту (Дэниел Гоулман)',
      'Обсуждайте чувства с близкими — это безопасная практика'
    ];
  } else {
    category = 'Низкий уровень EQ';
    interpretation = 'Эмоциональный интеллект требует значительного развития. Вам может быть трудно осознавать свои эмоции, понимать чувства других и управлять своим состоянием. Важно начать работу над этим аспектом — это улучшит качество жизни и отношений.';
    recommendations = [
      'Начните с простого: научитесь различать 6 базовых эмоций',
      'Каждый день называйте хотя бы 3 эмоции, которые испытали',
      'Смотрите на себя в зеркало и практикуйте выражение разных эмоций',
      'Рассмотрите возможность работы с психологом',
      'Читайте художественную литературу — это развивает эмпатию',
      'Практикуйте технику "STOP": остановись, сделай вдох, осознай, продолжи'
    ];
  }

  return {
    score,
    maxScore,
    category,
    interpretation,
    recommendations
  };
}

export const communicationStyleQuestions: TestQuestion[] = [
  {
    id: 'cs1',
    text: 'Как вы обычно выражаете свое мнение в семье?',
    options: [
      { value: 'assertive', label: 'Открыто и уверенно, уважая мнение других', score: 5 },
      { value: 'passive', label: 'Стараюсь не спорить и соглашаюсь с большинством', score: 2 },
      { value: 'aggressive', label: 'Настаиваю на своем, даже если другие не согласны', score: 3 },
      { value: 'passive-aggressive', label: 'Соглашаюсь, но потом делаю по-своему', score: 1 }
    ]
  },
  {
    id: 'cs2',
    text: 'Что вы делаете, когда член семьи вас критикует?',
    options: [
      { value: 'listen', label: 'Выслушиваю и обдумываю критику', score: 5 },
      { value: 'defend', label: 'Сразу начинаю защищаться и оправдываться', score: 2 },
      { value: 'attack', label: 'Критикую в ответ', score: 1 },
      { value: 'ignore', label: 'Делаю вид, что не обращаю внимания', score: 3 }
    ]
  },
  {
    id: 'cs3',
    text: 'Как часто вы используете "Я-сообщения" ("Я чувствую...", "Мне важно...")?',
    options: [
      { value: '5', label: 'Постоянно — это мой основной стиль общения', score: 5 },
      { value: '4', label: 'Часто — стараюсь говорить о своих чувствах', score: 4 },
      { value: '3', label: 'Иногда — когда помню об этом', score: 3 },
      { value: '2', label: 'Редко — чаще говорю "Ты делаешь...", "Ты всегда..."', score: 2 },
      { value: '1', label: 'Никогда — не вижу в этом смысла', score: 1 }
    ]
  },
  {
    id: 'cs4',
    text: 'Как вы реагируете на просьбы членов семьи?',
    options: [
      { value: 'clear', label: 'Ясно говорю "да" или "нет" и объясняю почему', score: 5 },
      { value: 'always-yes', label: 'Всегда соглашаюсь, даже если не хочу', score: 2 },
      { value: 'always-no', label: 'Часто отказываю, не объясняя причину', score: 1 },
      { value: 'maybe', label: 'Отвечаю "может быть" и откладываю решение', score: 3 }
    ]
  },
  {
    id: 'cs5',
    text: 'Как вы слушаете, когда с вами говорят?',
    options: [
      { value: 'active', label: 'Активно слушаю: смотрю в глаза, задаю вопросы, не перебиваю', score: 5 },
      { value: 'distracted', label: 'Слушаю, но часто отвлекаюсь на телефон или мысли', score: 3 },
      { value: 'interrupt', label: 'Часто перебиваю, чтобы высказать свое мнение', score: 2 },
      { value: 'pretend', label: 'Делаю вид, что слушаю, но думаю о своем', score: 1 }
    ]
  }
];

export function getCommunicationStyleResults(answers: Record<string, string>): TestResult {
  const scores: Record<string, number> = {};
  
  Object.entries(answers).forEach(([questionId, answer]) => {
    const question = communicationStyleQuestions.find(q => q.id === questionId);
    const option = question?.options.find(opt => opt.value === answer);
    if (option) {
      scores[answer] = (scores[answer] || 0) + option.score;
    }
  });

  const totalScore = Object.values(scores).reduce((sum, val) => sum + val, 0);
  const maxScore = 25;

  let category = '';
  let interpretation = '';
  let recommendations: string[] = [];

  if (totalScore >= 20) {
    category = 'Ассертивный стиль';
    interpretation = 'У вас здоровый ассертивный стиль общения! Вы умеете открыто выражать свои мысли и чувства, при этом уважая мнение других. Вы слушаете собеседника, используете "Я-сообщения" и четко обозначаете свои границы.';
    recommendations = [
      'Помогайте другим членам семьи развивать ассертивность',
      'Делитесь техниками эффективного общения',
      'Будьте примером конструктивного диалога'
    ];
  } else if (totalScore >= 15) {
    category = 'Смешанный стиль с преобладанием ассертивности';
    interpretation = 'У вас в целом конструктивный стиль общения, но в некоторых ситуациях вы можете быть излишне пассивными или агрессивными. Продолжайте развивать навыки ассертивности для более гармоничных отношений.';
    recommendations = [
      'Практикуйте "Я-сообщения" во всех ситуациях',
      'Учитесь говорить "нет" без чувства вины',
      'Развивайте навыки активного слушания',
      'Следите за своей реакцией в конфликтах'
    ];
  } else if (totalScore >= 10) {
    category = 'Смешанный стиль с пассивно-агрессивными элементами';
    interpretation = 'Ваш стиль общения часто колеблется между пассивностью и агрессией. Возможно, вам сложно напрямую выражать свои потребности, и вы либо избегаете конфликтов, либо реагируете слишком резко.';
    recommendations = [
      'Осознайте свои права: вы имеете право на свое мнение и чувства',
      'Практикуйте формулу: "Когда ты [поведение], я чувствую [эмоция], потому что [причина]"',
      'Учитесь выражать недовольство сразу, а не копить обиды',
      'Работайте над уверенностью в себе',
      'Рассмотрите тренинги по ассертивности'
    ];
  } else {
    category = 'Неэффективный стиль общения';
    interpretation = 'Ваш текущий стиль общения может создавать трудности в семейных отношениях. Возможно, вы либо слишком избегаете выражения своего мнения, либо выражаете его агрессивно, что мешает взаимопониманию.';
    recommendations = [
      'Начните с малого: выражайте свои предпочтения в мелочах (что поесть, что посмотреть)',
      'Учитесь различать пассивность, агрессию и ассертивность',
      'Запишитесь на курс или к психологу по развитию коммуникативных навыков',
      'Читайте книги: "Ассертивность" Ренни Фричи, "Язык жизни" Маршалл Розенберг',
      'Практикуйте техники ненасильственного общения',
      'Работайте над самооценкой — это основа ассертивности'
    ];
  }

  return {
    score: totalScore,
    maxScore,
    category,
    interpretation,
    recommendations
  };
}

export const loveLanguagesQuestions: TestQuestion[] = [
  {
    id: 'll1',
    text: 'Что вас больше всего радует от близких?',
    options: [
      { value: 'words', label: 'Когда мне говорят приятные слова, комплименты, признания в любви', score: 0 },
      { value: 'time', label: 'Когда проводят со мной время, полностью сосредоточившись на мне', score: 1 },
      { value: 'gifts', label: 'Когда дарят подарки, пусть даже маленькие и символические', score: 2 },
      { value: 'service', label: 'Когда делают что-то для меня (помогают, берут на себя задачи)', score: 3 },
      { value: 'touch', label: 'Когда обнимают, целуют, прикасаются', score: 4 }
    ]
  },
  {
    id: 'll2',
    text: 'Что вас больше всего обижает или расстраивает?',
    options: [
      { value: 'words', label: 'Критика, обидные слова или отсутствие похвалы', score: 0 },
      { value: 'time', label: 'Когда близкие постоянно заняты и не уделяют мне времени', score: 1 },
      { value: 'gifts', label: 'Когда забывают о важных датах и не дарят подарков', score: 2 },
      { value: 'service', label: 'Когда не помогают, когда мне нужна помощь', score: 3 },
      { value: 'touch', label: 'Недостаток физического контакта, холодность', score: 4 }
    ]
  },
  {
    id: 'll3',
    text: 'Как вы чаще всего показываете любовь близким?',
    options: [
      { value: 'words', label: 'Говорю приятные слова, делаю комплименты, хвалю', score: 0 },
      { value: 'time', label: 'Провожу с ними время, откладывая другие дела', score: 1 },
      { value: 'gifts', label: 'Дарю подарки, приношу сюрпризы', score: 2 },
      { value: 'service', label: 'Помогаю, делаю что-то полезное для них', score: 3 },
      { value: 'touch', label: 'Обнимаю, целую, прикасаюсь', score: 4 }
    ]
  },
  {
    id: 'll4',
    text: 'О чем вы чаще всего просите своих близких?',
    options: [
      { value: 'words', label: 'Сказать что-то приятное, поддержать словами', score: 0 },
      { value: 'time', label: 'Провести вместе время, поговорить, заняться чем-то вместе', score: 1 },
      { value: 'gifts', label: 'Купить/подарить что-то, о чем я давно мечтаю', score: 2 },
      { value: 'service', label: 'Помочь с делами, взять на себя какую-то задачу', score: 3 },
      { value: 'touch', label: 'Обнять, погладить, быть рядом физически', score: 4 }
    ]
  }
];

export function getLoveLanguagesResults(answers: Record<string, string>): TestResult {
  const languageScores: Record<string, number> = {
    words: 0,
    time: 0,
    gifts: 0,
    service: 0,
    touch: 0
  };

  Object.entries(answers).forEach(([, answer]) => {
    languageScores[answer] = (languageScores[answer] || 0) + 1;
  });

  const sortedLanguages = Object.entries(languageScores)
    .sort(([, a], [, b]) => b - a);

  const primaryLanguage = sortedLanguages[0][0];
  const secondaryLanguage = sortedLanguages[1][0];

  const languageNames: Record<string, string> = {
    words: 'Слова поддержки',
    time: 'Качественное время',
    gifts: 'Подарки',
    service: 'Помощь и забота',
    touch: 'Прикосновения'
  };

  const languageDescriptions: Record<string, string> = {
    words: 'Для вас самое важное — слышать слова любви, признательности и поддержки. Комплименты, похвала и ободряющие слова наполняют ваше сердце. Вы цените, когда близкие искренне говорят о своих чувствах.',
    time: 'Для вас любовь — это безраздельное внимание. Вы чувствуете себя любимым, когда близкие проводят с вами время, полностью сосредоточившись на вас. Важны не просто совместные занятия, а качество общения.',
    gifts: 'Подарки для вас — это символ любви и заботы. Важна не цена, а мысль и внимание. Вы помните все подарки и цените, когда близкие думают о вас и приносят что-то особенное.',
    service: 'Вы чувствуете любовь через действия. Когда близкие помогают вам, берут на себя часть забот — это говорит вам о любви громче слов. "Дела говорят громче слов" — это про вас.',
    touch: 'Физический контакт для вас — самое важное выражение любви. Объятия, поцелуи, прикосновения наполняют вас чувством близости и безопасности. Без физического контакта вы чувствуете себя одиноко.'
  };

  const recommendations: Record<string, string[]> = {
    words: [
      'Попросите близких чаще говорить вам приятные слова',
      'Заведите привычку обмениваться комплиментами каждый день',
      'Оставляйте друг другу любовные записки',
      'Говорите "спасибо" и "я ценю тебя" за конкретные вещи'
    ],
    time: [
      'Запланируйте регулярные свидания или семейные вечера без гаджетов',
      'Создайте традиции совместного времяпрепровождения',
      'Практикуйте активное слушание при общении',
      'Откладывайте телефон, когда разговариваете с близкими'
    ],
    gifts: [
      'Обменивайтесь небольшими сюрпризами без повода',
      'Создайте списки желаний, чтобы близкие знали, что вам нравится',
      'Цените символическое значение подарков, а не стоимость',
      'Дарите подарки, сделанные своими руками'
    ],
    service: [
      'Составьте список дел, с которыми нужна помощь',
      'Благодарите за помощь и конкретно говорите, что это значит для вас',
      'Предлагайте помощь близким в их делах',
      'Распределите домашние обязанности справедливо'
    ],
    touch: [
      'Обнимайтесь каждый день минимум 20 секунд',
      'Держитесь за руки во время прогулок',
      'Сидите рядом на диване, когда смотрите фильмы',
      'Практикуйте массаж и другие формы приятных прикосновений'
    ]
  };

  return {
    score: languageScores[primaryLanguage],
    maxScore: 4,
    category: `${languageNames[primaryLanguage]} + ${languageNames[secondaryLanguage]}`,
    interpretation: `Ваш основной язык любви — "${languageNames[primaryLanguage]}". ${languageDescriptions[primaryLanguage]} Вторичный язык — "${languageNames[secondaryLanguage]}". Важно, чтобы ваши близкие знали об этом и могли выражать любовь на понятном вам языке.`,
    recommendations: [
      ...recommendations[primaryLanguage],
      `Расскажите близким о вашем языке любви`,
      `Узнайте языки любви других членов семьи`,
      `Помните: люди часто выражают любовь на своем языке, а не на языке партнера`
    ]
  };
}
